<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Интерактивная диаграмма процессов</title>
  <style>
    :root{
      --bg:#f5f5f7;
      --panel:#fff;
      --border:rgba(0,0,0,0.08);
      --muted:rgba(0,0,0,0.55);
      --shadow:0 12px 30px rgba(0,0,0,0.10);
      --accent:rgba(0,122,255,0.92);
    }
    body{
      margin:0;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji";
      background:var(--panel);
      color:#111;
    }

    .app{
      display:grid;
      grid-template-columns: 280px 1fr 560px;
      height:100vh;
    }

    .nav{
      background:var(--bg);
      border-right:1px solid var(--border);
      padding:14px;
      overflow:auto;
    }
    .nav h1{
      font-size:14px;
      margin:0 0 10px 0;
      letter-spacing:-0.01em;
    }
    .nav .item{
      padding:10px 12px;
      border:1px solid rgba(0,0,0,0.06);
      border-radius:14px;
      background:rgba(255,255,255,0.72);
      cursor:pointer;
      margin-bottom:10px;
      user-select:none;
    }
    .nav .item:hover{background:rgba(255,255,255,0.95);}
    .nav .code{font-weight:850; font-size:12px; color:rgba(0,0,0,0.55);}
    .nav .title{font-weight:850; margin-top:4px;}
    .nav .desc{margin-top:4px; font-size:12px; color:rgba(0,0,0,0.55); line-height:1.25;}

    .center{
      display:flex;
      flex-direction:column;
      min-width:0;
      background:var(--bg);
      border-right:1px solid var(--border);
    }
    .toolbar{
      display:flex;align-items:center;gap:10px;
      padding:10px 12px;
      background:rgba(255,255,255,0.80);
      backdrop-filter: blur(14px);
      border-bottom:1px solid var(--border);
      position:sticky;top:0;z-index:10;
    }
    .toolbar button{
      padding:7px 10px;
      border:1px solid rgba(0,0,0,0.10);
      border-radius:12px;
      background:rgba(255,255,255,0.92);
      cursor:pointer;
    }
    .toolbar button:hover{background:rgba(245,245,245,0.98);}
    #zoomRange{width:220px;}
    .toolbar .label{font-size:12px;color:var(--muted);min-width:56px;}
    .toolbar .hint{font-size:12px;color:rgba(0,0,0,0.45); margin-left:auto;}

    #viewport{
      flex:1; overflow:auto; position:relative; cursor:grab;
      background:radial-gradient(900px 600px at 15% 20%, #ffffff 0%, #f5f5f7 60%, #f0f0f2 100%);
    }
    #viewport.dragging{cursor:grabbing;}
    #canvas{position:relative;display:inline-block;padding:0;margin:0;}
    #diagram{
      display:block;height:auto;
      user-select:none;-webkit-user-drag:none;
      filter: grayscale(0.25) contrast(1.20) brightness(0.98);
      opacity:0.80;
      transform:translateZ(0);
    }

    .right{
      padding:14px;
      overflow:auto;
      background:var(--panel);
    }

    .panelCard{border:1px solid rgba(0,0,0,.06);border-radius:18px;padding:14px;box-shadow:var(--shadow);background:rgba(255,255,255,0.78);backdrop-filter: blur(14px);}
    .hTitle{font-size:18px;font-weight:850;margin:0;letter-spacing:-0.02em;}
    .hSub{color:rgba(0,0,0,.55);font-size:12px;margin-top:6px;display:flex;gap:8px;flex-wrap:wrap}
    .badge{display:inline-flex;align-items:center;gap:6px;padding:4px 10px;border:1px solid rgba(0,0,0,.06);border-radius:999px;font-size:12px;background:rgba(255,255,255,0.65)}
    .muted{color:rgba(0,0,0,.50);font-size:13px}
    .section{margin-top:12px;border:1px solid rgba(0,0,0,.06);border-radius:14px;overflow:hidden}
    .section summary{list-style:none;cursor:pointer;padding:10px 12px;font-weight:750;background:rgba(250,250,250,0.72);display:flex;justify-content:space-between;align-items:center}
    .section summary::-webkit-details-marker{display:none}
    .section .content{padding:10px 12px;background:rgba(255,255,255,0.78);border-top:1px solid rgba(0,0,0,.06)}
    .list{margin:6px 0 0 18px}
    .pillRow{display:flex;flex-wrap:wrap;gap:8px}
    .pill{display:inline-flex;align-items:center;gap:8px;padding:6px 10px;border:1px solid rgba(0,0,0,.06);border-radius:999px;background:rgba(255,255,255,0.75)}
    .pill .k{font-weight:850}
    .pill .v{color:#333;font-size:13px}
    .checkItem{display:flex;gap:10px;align-items:flex-start;padding:6px 0}
    .checkItem input{margin-top:3px}
    .btnSmall{padding:6px 10px;border:1px solid rgba(0,0,0,.10);border-radius:10px;background:rgba(255,255,255,0.75);cursor:pointer}
    .btnSmall:hover{background:rgba(245,245,245,0.95)}
    .searchEmpty{color:rgba(0,0,0,.45);font-size:13px;margin-top:8px}

    #viewport::-webkit-scrollbar{height:10px;width:10px}
    #viewport::-webkit-scrollbar-thumb{background:rgba(0,0,0,0.15);border-radius:999px}
    #viewport::-webkit-scrollbar-track{background:transparent}

    .mobileTabs{
      display:none;
      gap:8px;
      padding:10px 12px;
      border-bottom:1px solid var(--border);
      background:rgba(255,255,255,0.85);
      backdrop-filter: blur(12px);
      position:sticky;
      top:0;
      z-index:30;
    }
    .mobileTabs button{
      flex:1;
      padding:10px 12px;
      border:1px solid rgba(0,0,0,0.10);
      border-radius:14px;
      background:rgba(255,255,255,0.92);
      font-weight:850;
      cursor:pointer;
    }
    .mobileTabs button.active{
      border-color: rgba(0,122,255,0.45);
      box-shadow: 0 0 0 3px rgba(0,122,255,0.10) inset;
    }

    @media (max-width: 980px){
      .app{ grid-template-columns: 1fr; }
      .mobileTabs{ display:flex; }

      .nav{ display:none; }
      .center{ display:none; border-right:none; }
      .right{ display:none; }

      .nav.mobileOn{ display:block; }
      .center.mobileOn{ display:flex; }
      .right.mobileOn{ display:block; width:auto; min-width:0; }
    }
  </style>
</head>
<body>

  <div class="mobileTabs" id="mobileTabs">
    <button id="tabStages">Этапы</button>
    <button id="tabDiagram" class="active">Диаграмма</button>
    <button id="tabDetails">Детали</button>
  </div>

  <div class="app">
    <aside class="nav">
      <h1>Этапы процесса</h1>

      <div class="item" data-group="P0"><div class="code">P0</div><div class="title">Старт проекта</div><div class="desc">Запрос, фиксация вводных, достаточность данных, техвладелец</div></div>
      <div class="item" data-group="P1"><div class="code">P1</div><div class="title">Пресейл и КП</div><div class="desc">Риски, партнёры, техчасть КП, архитектура, freeze, backlog</div></div>
      <div class="item" data-group="P2"><div class="code">P2</div><div class="title">Документация</div><div class="desc">Разработка ПРД/РД, QA, архитектурный контроль, согласование</div></div>
      <div class="item" data-group="P3"><div class="code">P3</div><div class="title">Спецификации и закупки</div><div class="desc">Спецификация, альтернативы, изменения, план, поставка</div></div>
      <div class="item" data-group="P4"><div class="code">P4</div><div class="title">Площадка и монтаж</div><div class="desc">Подготовка площадки, монтаж</div></div>
      <div class="item" data-group="P5"><div class="code">P5</div><div class="title">ПНР и изменения</div><div class="desc">ПНР, проблемы, диагностика, изменения, готовность к испытаниям</div></div>
      <div class="item" data-group="P6"><div class="code">P6</div><div class="title">Испытания и приёмка</div><div class="desc">Критерии, испытания, проверка, принято</div></div>
      <div class="item" data-group="P7"><div class="code">P7</div><div class="title">Исполнительная и закрытие</div><div class="desc">Исполнительная, инструкция, приёмка, передача</div></div>
      <div class="item" data-group="S1"><div class="code">S1</div><div class="title">Сервис</div><div class="desc">Сервисные обращения и эскалации</div></div>
    </aside>

    <main class="center">
      <div class="toolbar">
        <button id="zoomOut">−</button>
        <input id="zoomRange" type="range" min="60" max="220" value="120" />
        <button id="zoomIn">+</button>
        <button id="zoomFit">Fit</button>
        <div class="label" id="zoomLabel">120%</div>
        <div class="hint">Выбери этап слева</div>
      </div>

      <div id="viewport">
        <div id="canvas">
          <img id="diagram" src="diagram.png" alt="Диаграмма"/>
        </div>
      </div>
    </main>

    <aside class="right" id="panel"></aside>
  </div>

  <script src="app.js"></script>
</body>
</html>
